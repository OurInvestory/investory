# 📋 기능 명세서 (Feature Specification)

## 1. 개요

### 1.1 프로젝트 소개
**Investory**는 모의투자와 게이미피케이션을 결합한 투자 학습 플랫폼입니다.

### 1.2 주요 목표
- 실제 시장 데이터를 활용한 안전한 모의투자 환경 제공
- 게이미피케이션을 통한 투자 학습 동기 부여
- WMTI 분석을 통한 개인별 투자 성향 파악

---

## 2. 기능 명세

### 2.1 인증 (Authentication)

#### 2.1.1 회원가입
| 항목 | 내용 |
|------|------|
| **기능 ID** | AUTH-001 |
| **기능명** | 회원가입 |
| **설명** | 사용자가 아이디, 비밀번호, 이메일, 닉네임을 입력하여 계정을 생성 |
| **선행조건** | 없음 |
| **입력 데이터** | loginId, password, email, nickname, phone(선택) |
| **처리 로직** | 1. 아이디/이메일 중복 확인<br>2. 비밀번호 암호화<br>3. 사용자 정보 저장<br>4. 초기 레벨(1) 및 경험치(0) 설정 |
| **출력 데이터** | 사용자 정보 (userId, loginId, email, nickname) |
| **예외 처리** | - 아이디 중복 (U001)<br>- 이메일 중복 (U002)<br>- 유효성 검증 실패 |

#### 2.1.2 로그인
| 항목 | 내용 |
|------|------|
| **기능 ID** | AUTH-002 |
| **기능명** | 로그인 |
| **설명** | 아이디와 비밀번호로 인증 후 JWT 토큰 발급 |
| **선행조건** | 회원가입 완료 |
| **입력 데이터** | loginId, password |
| **처리 로직** | 1. 사용자 조회<br>2. 비밀번호 검증<br>3. Access Token, Refresh Token 생성<br>4. 최종 로그인 시간 업데이트 |
| **출력 데이터** | accessToken, refreshToken, expiresIn, 사용자 정보 |
| **예외 처리** | - 사용자 없음 (U003)<br>- 비밀번호 불일치 (A003) |

#### 2.1.3 토큰 갱신
| 항목 | 내용 |
|------|------|
| **기능 ID** | AUTH-003 |
| **기능명** | 토큰 갱신 |
| **설명** | Refresh Token을 사용하여 새로운 Access Token 발급 |
| **선행조건** | 유효한 Refresh Token 보유 |
| **입력 데이터** | refreshToken |
| **처리 로직** | 1. Refresh Token 검증<br>2. 새로운 Access Token 생성 |
| **출력 데이터** | 새로운 accessToken, refreshToken |
| **예외 처리** | - 토큰 만료 (A001)<br>- 유효하지 않은 토큰 (A002) |

---

### 2.2 사용자 (User)

#### 2.2.1 프로필 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | USER-001 |
| **기능명** | 프로필 조회 |
| **설명** | 현재 로그인한 사용자의 프로필 정보 조회 |
| **선행조건** | 로그인 상태 |
| **출력 데이터** | userId, loginId, email, nickname, phone, profileImage, level, experience, wmtiType |

#### 2.2.2 프로필 수정
| 항목 | 내용 |
|------|------|
| **기능 ID** | USER-002 |
| **기능명** | 프로필 수정 |
| **설명** | 닉네임, 전화번호, 프로필 이미지 수정 |
| **입력 데이터** | nickname, phone, profileImage |
| **처리 로직** | 변경된 필드만 업데이트 |

#### 2.2.3 비밀번호 변경
| 항목 | 내용 |
|------|------|
| **기능 ID** | USER-003 |
| **기능명** | 비밀번호 변경 |
| **설명** | 현재 비밀번호 확인 후 새 비밀번호로 변경 |
| **입력 데이터** | currentPassword, newPassword |
| **예외 처리** | - 현재 비밀번호 불일치 (A003) |

---

### 2.3 주식 (Stock)

#### 2.3.1 주식 목록 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | STOCK-001 |
| **기능명** | 주식 목록 조회 |
| **설명** | 전체 주식 목록을 시장/섹터별로 필터링하여 조회 |
| **입력 데이터** | market(선택), sector(선택), keyword(선택), page, size |
| **출력 데이터** | 주식 목록 (페이징) |

#### 2.3.2 주식 상세 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | STOCK-002 |
| **기능명** | 주식 상세 조회 |
| **설명** | 특정 종목의 상세 정보 조회 |
| **입력 데이터** | stockCode |
| **출력 데이터** | 종목 상세 정보, 호가 정보 |

#### 2.3.3 호가 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | STOCK-003 |
| **기능명** | 호가 조회 |
| **설명** | 특정 종목의 매수/매도 호가 조회 |
| **출력 데이터** | 매수 호가 10개, 매도 호가 10개 |

#### 2.3.4 관심종목 추가/제거
| 항목 | 내용 |
|------|------|
| **기능 ID** | STOCK-004 |
| **기능명** | 관심종목 토글 |
| **설명** | 관심종목 목록에 추가하거나 제거 (토글 방식) |
| **입력 데이터** | stockCode |
| **처리 로직** | 1. 기존 관심종목 여부 확인<br>2. 있으면 제거, 없으면 추가 |

#### 2.3.5 관심종목 목록 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | STOCK-005 |
| **기능명** | 관심종목 목록 조회 |
| **설명** | 사용자의 관심종목 목록 조회 |
| **출력 데이터** | 관심종목 리스트 (종목 정보 포함) |

---

### 2.4 주문 (Order)

#### 2.4.1 주문 생성
| 항목 | 내용 |
|------|------|
| **기능 ID** | ORDER-001 |
| **기능명** | 주문 생성 |
| **설명** | 매수/매도 주문 생성 및 즉시 체결 |
| **입력 데이터** | stockCode, orderType(MARKET/LIMIT), side(BUY/SELL), quantity, price(지정가인 경우) |
| **처리 로직** | 1. 주문 유효성 검증<br>2. 매도 시 보유수량 확인<br>3. 주문 생성<br>4. 즉시 체결 (모의투자)<br>5. 포트폴리오 업데이트<br>6. 경험치 부여 |
| **경험치** | 주문 체결 시 10 EXP |
| **예외 처리** | - 잔고 부족 (O001)<br>- 보유수량 부족 (O002) |

#### 2.4.2 주문 취소
| 항목 | 내용 |
|------|------|
| **기능 ID** | ORDER-002 |
| **기능명** | 주문 취소 |
| **설명** | 미체결 주문 취소 |
| **입력 데이터** | orderId, reason(선택) |
| **예외 처리** | - 이미 체결된 주문 (O003) |

#### 2.4.3 주문 내역 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | ORDER-003 |
| **기능명** | 주문 내역 조회 |
| **설명** | 사용자의 주문 내역 조회 |
| **입력 데이터** | status(선택), page, size |
| **출력 데이터** | 주문 내역 리스트 (페이징) |

---

### 2.5 포트폴리오 (Portfolio)

#### 2.5.1 포트폴리오 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | PORTFOLIO-001 |
| **기능명** | 포트폴리오 조회 |
| **설명** | 보유 종목 및 손익 현황 조회 |
| **출력 데이터** | 총 평가금액, 총 투자금액, 총 손익, 총 수익률, 보유 종목 리스트 |

#### 2.5.2 포트폴리오 요약
| 항목 | 내용 |
|------|------|
| **기능 ID** | PORTFOLIO-002 |
| **기능명** | 포트폴리오 요약 |
| **설명** | 대시보드용 간략한 포트폴리오 정보 |
| **출력 데이터** | 총 평가금액, 총 손익, 총 수익률, 보유 종목 수 |

---

### 2.6 WMTI (투자 성향 분석)

#### 2.6.1 테스트 문항 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | WMTI-001 |
| **기능명** | WMTI 문항 조회 |
| **설명** | 투자 성향 테스트 20개 문항 조회 |
| **출력 데이터** | 문항 리스트 (질문, 선택지 A/B) |

#### 2.6.2 테스트 결과 제출
| 항목 | 내용 |
|------|------|
| **기능 ID** | WMTI-002 |
| **기능명** | WMTI 결과 제출 |
| **설명** | 사용자 응답 제출 및 유형 분석 |
| **입력 데이터** | answers (20개 응답) |
| **처리 로직** | 1. 응답 분석 (E/I, S/N, T/F, J/P)<br>2. WMTI 유형 도출<br>3. 결과 저장<br>4. 경험치 부여 (최초 1회) |
| **경험치** | 최초 테스트 완료 시 50 EXP |
| **출력 데이터** | WMTI 유형, 유형 설명, 투자 특성, 추천 전략 |

#### 2.6.3 결과 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | WMTI-003 |
| **기능명** | WMTI 결과 조회 |
| **설명** | 저장된 WMTI 결과 조회 |
| **출력 데이터** | WMTI 유형 정보, 테스트 일시 |

---

### 2.7 리워드 (Reward)

#### 2.7.1 레벨 정보 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | REWARD-001 |
| **기능명** | 레벨 정보 조회 |
| **설명** | 현재 레벨, 경험치, 다음 레벨까지 필요 경험치 조회 |
| **출력 데이터** | currentLevel, currentExp, nextLevelExp, progress(%) |

#### 2.7.2 업적 목록 조회
| 항목 | 내용 |
|------|------|
| **기능 ID** | REWARD-002 |
| **기능명** | 업적 목록 조회 |
| **설명** | 전체 업적 및 달성 현황 조회 |
| **출력 데이터** | 업적 리스트 (업적 정보, 달성 여부, 달성 일시) |

---

## 3. WMTI 유형

| 유형 | 이름 | 설명 |
|------|------|------|
| ESTJ | 실용적 투자자 | 체계적이고 현실적인 투자 스타일 |
| ESTP | 기회추구 투자자 | 단기 기회를 포착하는 적극적 스타일 |
| ESFJ | 안정추구 투자자 | 안전한 투자를 선호하는 보수적 스타일 |
| ESFP | 경험중시 투자자 | 직접 경험을 통해 배우는 스타일 |
| ENTJ | 전략적 투자자 | 장기적 관점의 전략적 투자 스타일 |
| ENTP | 혁신적 투자자 | 새로운 기회를 탐색하는 혁신적 스타일 |
| ENFJ | 가치투자자 | ESG, 가치 중심의 투자 스타일 |
| ENFP | 성장추구 투자자 | 성장 가능성에 투자하는 스타일 |

---

## 4. 레벨 시스템

| 레벨 | 필요 경험치 | 누적 경험치 |
|------|------------|------------|
| 1 | 0 | 0 |
| 2 | 100 | 100 |
| 3 | 200 | 300 |
| 4 | 300 | 600 |
| 5 | 400 | 1,000 |
| ... | Level × 100 | - |

### 경험치 획득
| 활동 | 경험치 |
|------|-------|
| 주문 체결 | 10 EXP |
| WMTI 최초 완료 | 50 EXP |
| 업적 달성 | 업적별 상이 |

---

## 5. 업적 시스템

| 업적 ID | 이름 | 조건 | 보상 EXP |
|---------|------|------|----------|
| FIRST_TRADE | 첫 거래 | 첫 번째 주문 체결 | 50 |
| TRADE_10 | 주린이 탈출 | 10회 거래 완료 | 100 |
| TRADE_50 | 베테랑 트레이더 | 50회 거래 완료 | 200 |
| PROFIT_10 | 수익왕 | 10% 이상 수익 달성 | 150 |
| DIVERSIFY | 분산투자 마스터 | 5개 이상 종목 보유 | 100 |
| WMTI_COMPLETE | 나를 알다 | WMTI 테스트 완료 | 50 |
| LEVEL_5 | 성장 중 | 레벨 5 달성 | 100 |
| WATCHLIST_10 | 종목 헌터 | 관심종목 10개 등록 | 50 |
